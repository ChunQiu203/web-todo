# 项目说明文档

## 项目概述
本项目结合了 Vue 3 + Vite 构建前端界面，使用 FastAPI 搭建后端服务，同时借助 LangChain 实现 AI 交互功能，为用户提供日程管理以及智能对话服务。项目还涉及数据库操作，使用 SQLAlchemy 进行数据持久化存储。

## 环境配置

### 后端（Python 9.13 + FastAPI + LangChain）
#### 1. 安装 Python 9.13
请确保你已经安装了 Python 9.13 版本。你可以从 Python 官方网站下载并安装：[Python 下载地址](https://www.python.org/downloads/)

#### 2. 创建虚拟环境
在项目根目录下，打开终端并执行以下命令创建虚拟环境：
```bash
python -m venv venv
```

#### 3. 激活虚拟环境
- **Windows**
```bash
venv\Scripts\activate
```
- **Linux/Mac**
```bash
source venv/bin/activate
```

#### 4. 安装依赖
在激活虚拟环境后，执行以下命令安装后端所需的依赖：
```bash
pip install fastapi sqlalchemy langchain requests beautifulsoup4 uvicorn
```

### 前端（Vue 3 + Vite）
#### 1. 安装 Node.js
请确保你已经安装了 Node.js。你可以从 Node.js 官方网站下载并安装：[Node.js 下载地址](https://nodejs.org/)

#### 2. 安装项目依赖
在项目根目录下，打开终端并执行以下命令安装前端所需的依赖：
```bash
npm install
```

## 项目启动

### 后端启动
在激活虚拟环境后，执行以下命令启动 FastAPI 服务：
```bash
uvicorn main:app --reload
```
这将启动一个本地服务器，默认地址为 `http://127.0.0.1:8000`。

### 前端启动
在项目根目录下，打开终端并执行以下命令启动 Vue 3 + Vite 开发服务器：
```bash
npm run dev
```
这将启动一个本地开发服务器，默认地址为 `http://localhost:5173`。

## 文档说明

### 后端 API 说明
#### 1. 用户相关 API
- **获取用户信息**
  - **URL**：`/users/{username}`
  - **方法**：`GET`
  - **描述**：根据用户名获取用户信息。
  - **返回值**：用户信息对象。

- **创建用户**
  - **URL**：`/users/`
  - **方法**：`POST`
  - **描述**：创建新用户。
  - **请求体**：包含用户名和密码的 JSON 对象。
  - **返回值**：新创建的用户信息对象。

#### 2. 日程相关 API
- **获取用户日程**
  - **URL**：`/users/{user_id}/schedules/`
  - **方法**：`GET`
  - **描述**：根据用户 ID 获取用户的日程列表。
  - **返回值**：日程列表。

- **创建日程**
  - **URL**：`/users/{user_id}/schedules/`
  - **方法**：`POST`
  - **描述**：为指定用户创建新日程。
  - **请求体**：包含日程标题、描述、开始时间和结束时间的 JSON 对象。
  - **返回值**：新创建的日程信息对象。

#### 3. AI 聊天相关 API
- **获取 AI 历史对话**
  - **URL**：`/ai/history/{user_id}`
  - **方法**：`GET`
  - **描述**：根据用户 ID 获取用户的 AI 历史对话记录，支持按角色过滤。
  - **参数**：
    - `limit`：返回记录的最大数量，默认值为 20。
    - `role`：过滤角色，可选参数。
  - **返回值**：AI 历史对话记录列表。

- **创建 AI 历史对话**
  - **URL**：`/ai/history/`
  - **方法**：`POST`
  - **描述**：创建新的 AI 历史对话记录。
  - **请求体**：包含用户 ID、角色、内容和代理角色的 JSON 对象。
  - **返回值**：新创建的 AI 历史对话记录信息对象。

- **与 AI 聊天**
  - **URL**：`/ai/chat/`
  - **方法**：`POST`
  - **描述**：与 AI 进行聊天交互。
  - **请求体**：包含消息、用户 ID、历史记录和代理角色的 JSON 对象。
  - **参数**：
    - `model`：使用的 AI 模型，默认值为 `qwen-plus`。
    - `role`：AI 角色，默认值为 `enforcer`。
  - **返回值**：AI 回复信息对象。

### 前端页面说明
#### 1. 日程管理页面（ScheduleManager.vue）
- **侧边栏**：提供日程分类导航，包括收件箱、今天、未来 7 天等。
- **任务列表**：显示不同分类下的任务列表，支持任务选择和完成状态切换。
- **任务详情**：显示选中任务的详细信息。
- **AI 助手**：提供智能任务安排和对话功能，支持选择不同的 AI 模型和角色。

#### 2. 聊天界面页面（ChatInterface.vue）
- **模型和角色选择**：支持选择不同的 AI 模型和角色。
- **历史记录栏**：显示聊天历史记录。
- **聊天记录显示区域**：实时显示聊天消息。
- **输入区域**：用于输入聊天消息并发送。

## 注意事项
- 请确保在启动项目前，已经完成了环境配置和依赖安装。
- 后端服务和前端服务需要分别启动，并且要确保它们在同一网络环境下运行。
- 在使用 AI 聊天功能时，可能需要根据实际情况配置 AI 模型的 API 密钥和相关参数。
